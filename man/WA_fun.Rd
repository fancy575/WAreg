% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/WA_fun.R
\name{WA_fun}
\alias{WA_fun}
\title{Process WA Regression Results (Internal)}
\usage{
WA_fun(
  model,
  data,
  cluster = NULL,
  id,
  wr,
  wd,
  link,
  cens_mod,
  sp_knots,
  degree = 3,
  cal_var = F
)
}
\arguments{
\item{model}{A survival model formula (e.g., \code{Surv(time, type) ~ Z1 + Z2}).}

\item{data}{A data frame containing the data.}

\item{cluster}{Optional. A string specifying the cluster variable name (if applicable).}

\item{id}{A string specifying the subject ID column name.}

\item{wr}{A numeric vector of weights for recurrent events.}

\item{wd}{A numeric value for the terminal event weight.}

\item{link}{Link function for while alive loss rate.}

\item{cens_mod}{A survival model formula for the censoring distribution (e.g., \code{Surv(time, delta) ~ Z2}).}

\item{sp_knots}{A numeric vector of spline knot locations.}

\item{degree}{A non-negative integer specifying the polynomial degree for the spline (default is 3).}

\item{cal_var}{Logical; if \code{TRUE}, the variance estimate is computed using \code{cal_V} (default is \code{FALSE}).}
}
\value{
A list of class \code{"WA_obj"} containing:
\describe{
  \item{model}{The original model formula.}
  \item{data}{The input data.}
  \item{cluster}{The cluster variable name (if provided).}
  \item{id}{The subject ID column name.}
  \item{wr}{The recurrent event weights.}
  \item{wd}{The terminal event weight.}
  \item{cens_model}{The censoring model formula.}
  \item{sp_knots}{The spline knot locations used.}
  \item{degree}{The polynomial degree for the spline.}
  \item{WA_out}{A list containing the estimated WA outcomes (e.g., estimated coefficients and covariance matrix).}
  \item{variance}{The variance estimate (if computed, otherwise \code{NULL}).}
  \item{fit}{The fitted object returned by \code{WA_fit}.}
}
}
\description{
This internal function wraps the WA regression fitting procedure. It calls
\code{WA_fit} to fit the model and, optionally, \code{cal_V} to compute a variance estimate.
The function then assembles a list with all relevant inputs and outputs, and returns an object
of class \code{"WA_obj"}.
}
\keyword{internal}
