% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util_fun.R
\name{PE_cal}
\alias{PE_cal}
\title{Calculate Prediction Error for WA Regression (Internal)}
\usage{
PE_cal(
  model,
  data,
  cluster = NULL,
  id,
  wr,
  wd,
  link,
  cens_mod,
  sp_knots,
  degree,
  beta,
  t_span
)
}
\arguments{
\item{model}{A survival model formula (e.g., \code{Surv(time, type) ~ Z1 + Z2}).}

\item{data}{A data frame containing the data used in the analysis, including the observed outcome
in the \code{N_R} column.}

\item{cluster}{Optional; a string giving the cluster column name (if applicable).}

\item{id}{A string giving the subject ID column name.}

\item{wr}{A numeric vector of weights for recurrent events.}

\item{wd}{A numeric weight for the terminal event.}

\item{link}{Link function for while-alive loss rate.}

\item{cens_mod}{A survival model formula for the censoring distribution.}

\item{sp_knots}{A numeric vector of spline knot locations.}

\item{degree}{A non-negative integer specifying the polynomial degree for the spline.}

\item{beta}{A numeric vector of estimated coefficients corresponding to the spline-expanded basis.}

\item{t_span}{A numeric vector of time points at which to evaluate prediction error.}
}
\value{
A list with components:
\describe{
  \item{PE}{The overall prediction error (mean squared error).}
  \item{pred_err}{A matrix of squared errors with subjects as rows and times as columns.}
}
}
\description{
This internal function calculates a prediction error (PE) measure for the WA regression model.
For each subject in the data, it computes the predicted effect at time points specified in
\code{t_span} using the spline basis (via \code{gen_cov_prod}) and compares it to the observed
outcome (assumed to be in the \code{N_R} column). The overall prediction error is computed as the
mean squared error across subjects and time points.
}
\keyword{internal}
