% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/util_fun.R
\name{cal_V}
\alias{cal_V}
\title{Calculate Variance V (Internal)}
\usage{
cal_V(fd_dt, beta, cov_vars, link)
}
\arguments{
\item{fd_dt}{A data frame containing the following required columns:
\itemize{
  \item \code{etime} - event time,
  \item \code{delta} - censoring indicator (0 indicates censoring),
  \item \code{tau} - the evaluated spline time,
  \item \code{X_tau} - the minimum event time for each subject,
  \item \code{V_tau} - numerator for censoring weights,
  \item \code{G_X_tau} - denominator for censoring weights,
  \item \code{j} - subject id,
  \item \code{i} - cluster id,
  \item and the expanded spline covariate columns (with names matching a pattern based on \code{cov_vars}).
}}

\item{beta}{A numeric vector of estimated coefficients corresponding to the expanded covariate columns.}

\item{cov_vars}{A character vector of covariate names used to construct the spline-expanded covariate columns.}
}
\value{
A matrix representing the estimated variance \eqn{V}.
}
\description{
This function calculates the variance estimate \eqn{V} for the WA regression estimator.
It uses the expanded covariate matrix (constructed based on spline basis functions)
from \code{fd_dt}, the coefficient vector \code{beta}, and the covariate names in \code{cov_vars}.
}
\keyword{internal}
